---
title: "Third Assignment"
author: "Emilia Sicari & Rafael Lopez V."
date: "March 25, 2016"
output:
  pdf_document:
    number_sections: yes
    toc: yes
    toc_depth: 2
  html_document:
    toc: yes
    toc_depth: '2'
subtitle: Christopher Gandrud, Hertie School of Governance, Spring 2016
bibliography: 
  - bibliography.bib
  - packages.bib
---

```{r setup, include=FALSE, error=FALSE, message=FALSE, results = 'asis'}
knitr::opts_chunk$set(echo = TRUE) 

#setting working directory
getwd()
try(setwd('/Users/emiliasicari/Desktop/Third-assignment-'), silent = TRUE)
try(setwd("/Users/rafalopezv/Dropbox/R/Third-assignment/"), silent = TRUE)


#loading packages or installing them if not already available
library(devtools)
library(Quandl)
library(data.table)
library(rio)
library(ggplot2)

# creating an object of the packages for citation purposes
packages <- c('devtools', 'repmis', 'Quandl', 'data.table', 'rio', 'ggplot2')
repmis::LoadandCite(packages, file = 'packages.bib')

# importing data on Singapore's economic growth, selecting only the time span of interest
URL <- "https://www.quandl.com/api/v3/datasets/ODA/SGP_NGDPPC.csv"
gdp.pc <- repmis::source_data(URL, header = TRUE, nrow(30), skip = 11)

# showing data as data frame
data.frame(main)

#adding a new column, and inserting content 
main["MY_NEW_COLUMN"] <- 'singapore' #I think it is not neccessary since Singapore is the only country we are working on

#changing the names of the columns
names(main) <- c("date", "gdp per capita","country")

#changing order of columns
main[,c(3,2,1)]

#importing data on Singapore's income inequality, selecting only the time span of interest
MyData <- read.csv2(file="ObservationData_wvdxeeg.csv", header=TRUE, sep = ",", nrows = 17, skip = 32)

#showing data as data frame
data.frame(MyData)

#changing the names of the columns
names(MyData) <- c("country", "inverted pareto lorenz coefficient", "unit", "date", "inequality")

#Downloading data set for public transport utilisation (from 1995 to 2015)
a <- "https://data.gov.sg/dataset/7f0661dc-6e4f-460f-8e8c-3514c9a8cb6b/resource/552b8662-3cbc-48c0-9fbb-abdc07fb377a/download/public-transport-utilisation-average-public-transport-ridership.csv"
trans.ut <- repmis::source_data(a)

#Changing the name of the colums 
names(trans.ut) <- c("year","type","average.1000.day")

#Checking the class of the data
sapply(trans.ut, class)

# Subsetting the "trans.ut file" to make it compatible with the other data and foreseeing the merging process 
trans.ut.mrt <- data.frame(subset(trans.ut, type == "MRT"))
trans.ut.bus <- data.frame(subset(trans.ut, type == "Bus"))
trans.ut.lrt <- data.frame(subset(trans.ut, type == "LRT"))
trans.ut.taxi <- data.frame(subset(trans.ut, type == "Taxi"))

#Downloading data for car population (from 1965 to 2015)
b <- "https://data.gov.sg/dataset/e2673131-f79f-43e3-9579-c17cc25e1735/resource/31ca0cee-6d9e-453a-8b4f-376d37713a10/download/motor-vehicle-population-by-type-of-vehicle-end-of-period-annual.csv"
car.pop <- repmis::source_data(b)

#Changing the name of the colums
names(car.pop) <- c("year", "type", "number")

# Eliminating the years that are not compatible with the other data sets
car.pop1 <- data.frame(subset(car.pop, year > "1994"))
mean(car.pop1$number)

#Checking the class of the data
sapply(car.pop1, class)

#Transform the data of one of the columns that have been imported as characters
car.pop1 <- transform(car.pop1, number = as.numeric(number))

# Subsetting the "car.pop1 file" to make it compatible with the other data and foreseeing the merging process 
car.pop1.cars <- data.frame(subset(car.pop1, type == "Cars"))
car.pop1.rentalcars <- data.frame(subset(car.pop1, type == "Rental Cars"))
car.pop1.taxis <- data.frame(subset(car.pop1, type == "Taxis"))
car.pop1.buses <- data.frame(subset(car.pop1, type == "Buses"))
car.pop1.motorbikes <- data.frame(subset(car.pop1, type == "Motorcycles & Scooters"))
car.pop1.other <- data.frame(subset(car.pop1, type == "Goods & Other Vehicles"))
```

\pagebreak

#Research question and project description
In our collaborative research project, we seeks to provide an answer to the following question: **How the rise in the rise in inequality and economic growth influences the purchase of luxury goods, particularly cars, and the usage of public transportation systems in Singapore, from 1960 to 2015**. 
Therefore, we collected data on economic growth, income inequality, usage of public transports and purchase of cars covering the time span of 29 years, from 1980 until 2009. As suggested by our research question, economic growth, income inequality and usage of public transports are the explanatory variables, while purchase of cars is the dependent variable. The reason why we chose cars as example of luxury goods showing social status, is that in Singapore purchasing of cars is particularly expensive, due to high taxation and a certificate of car entitlement, whose cost can be higher than 70.000 dollars. For more details about the research proposal and case justification see [ResearchProposal](https://github.com/EmiliaSicari/ResearchProposal).

#Processing data

##Data sources and data gathering
The data that we need for our empirical analysis are to be retrieved from different sources:

* IMF Cross Country Macroeconomic Statistics open data, containing cross-country marcoeconomic data.From this source we downloaded the dataset on Singapore GDP per Capita at Current Prices measured in national currency from 1980 until 2020 (forecasts) . Data were downloaded in csv format from [Quandl](https://www.quandl.com/data/ODA/SGP_NGDPPC), providing high-quality financial and economic data in different formats to facilitate data analysis.

* [Knoema](http://knoema.com/), a knowledge platform connecting data with analytical and presentation tools, in order to allow users to access, present and share data-driven content. From  The World Top Incomes Database - providing access to data on the distribution of top incomes in more than twenty five countries across the globe - we downloaded data about income inequality on Singapore measured by the inverted Pareto-Lorenz coefficient from 1947 until 2009. This coefficient, measures the average income of people above y, relative to y, providing a direct and intuitiver measure of the fatness of the upper tail of the distribution: the higher the coefficient, the larger the shares of top incomes (meaning an higher top income inequality). In practice, the coefficient typically varies between 1.5 and 2.5: values around 1.5 or below indicate low top income inequality, while values around 2.5 or below indicate high top income inequality. A value of 1.5 means that people above a specified level have on average 50 per cent more income; a value of 2.5 means that they have 150 per cent more income [@atkinson2009top]
The reason why we did not gather data from the database [Clio Infra](https://www.quandl.com/data/CLIO/SGP_II-Income-Inequality-Singapore) available on Quandl as we had defined in our [ResearchProposal](https://github.com/EmiliaSicari/ResearchProposal) , is that it did not provide sufficient data for the time span we are considering. 

* PUBLIC TRANSPORTS
* PURCHASE OF CARS

##Cleaning and merging of datasets
After importing data on R and cleaning them, we merged the datasets. The final dataset has TOT observations....

#Descriptive and inferential statistics

#References